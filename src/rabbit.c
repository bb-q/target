#include <math.h>
#include <cairo/cairo.h>

double rabbit_body[] = {
    211.02301, 508.93799 ,
    -81.16943,-4.72899,-89.51635,-5.81378,-109.47535,-14.22765 ,
    -9.580868,-4.03889,-15.830238,-5.14461,-28.810678,-5.09752 ,
    -9.26274,0.0336,-11.03365,-0.20087,-15.87811,-2.10227 ,
    -70.489127,-35.36039,-44.224055,-113.09258,-20.62152,-86.38496 ,
    2.65104,2.31986,5.34095,4.21794,5.97759,4.21794 ,
    0.63663,0,1.74293,-0.8358,2.45844,-1.85733 ,
    1.07153,-1.52982,1.30244,-4.80851,1.30954,-18.59409 ,
    0.0167,-32.42977,4.23454,-62.43575,10.81048,-76.90643 ,
    8.2507,-18.1561,56.231248,-62.26477,81.685498,-75.09374 ,
    15.21365,-7.6677,52.03131,-13.21194,75.31008,-11.34069 ,
    16.67229,1.3402,35.04515,6.65428,46.21325,13.36651 ,
    9.91335,5.95809,10.40399,5.85033,21.84038,-4.79705 ,
    6.06608,-5.64757,10.56127,-8.33195,16.50997,-9.85924 ,
    4.65285,-1.19458,6.92231,-4.25445,8.1903,-11.04277 ,
    1.31742,-7.05297,2.98039,-40.4226,2.40622,-48.28392 ,
    -0.69241,-9.48017,-2.44597,-13.74047,-9.24843,-22.46921 ,
    -16.44083,-21.09644,-24.88201,-34.98161,-27.90395,-45.900077 ,
    -1.25454,-4.53273,-1.43974,-9.60946,-1.43974,-39.46517 ,
    0,-30.664771,0.14911,-34.53549,1.41974,-36.85517 ,
    3.0294,-5.53048,10.52159,-7.9150804,19.70954,-6.2731004 ,
    11.08738,1.9814204,19.82591,9.3325804,29.58315,24.8863804 ,
    7.88403,12.56777,11.88114,16.48448,13.74507,13.4686 ,
    0.34423,-0.55698,0.91039,-5.25251,1.25814,-10.43452 ,
    0.38166,-5.6875,1.16446,-10.543361,1.97502,-12.251501 ,
    1.55752,-3.28222,5.325,-5.25548,12.04108,-6.306639 ,
    7.01324,-1.09767,9.65127,0.0146,13.20299,5.566859 ,
    7.60239,11.884431,19.14947,38.230851,25.69413,58.625021 ,
    5.85384,18.241497,7.84634,28.420847,8.80197,44.968007 ,
    0.48357,8.37335,1.09754,15.79319,1.36437,16.48855 ,
    0.60451,1.57532,5.39115,2.95295,10.34713,2.97796 ,
    7.47048,0.0377,21.93101,4.73082,29.74045,9.65216 ,
    5.26641,3.31878,8.39866,7.11846,16.83558,20.42301 ,
    3.64336,5.74536,8.71369,13.35707,11.26742,16.91488 ,
    2.79355,3.89196,6.03125,9.92261,8.12781,15.13918 ,
    3.48179,8.66321,4.81681,10.52744,12.54335,17.51552 ,
    6.52435,5.90079,10.04598,17.57145,7.29148,24.16388 ,
    -1.53003,3.66186,-12.40054,19.01412,-18.45372,26.06189 ,
    -2.84867,3.31675,-5.68071,5.60105,-8.60235,6.93862 ,
    -5.80825,2.6591,-19.0265,5.85799,-31.7422,7.68177 ,
    -9.70953,1.39262,-10.5476,1.66303,-13.23904,4.27167 ,
    -3.25972,3.15945,-4.97403,7.41076,-4.11493,10.2046 ,
    0.32023,1.04139,2.39217,4.61607,4.6043,7.94373 ,
    4.79756,7.21686,5.41359,10.28137,4.65295,23.14673 ,
    -0.66811,11.30013,-2.24044,19.01804,-4.97308,24.41063 ,
    -3.01249,5.94486,-3.8433,9.76038,-4.76634,21.8895 ,
    -0.91585,12.03464,-2.8354,19.45359,-6.54674,25.30279 ,
    -4.18661,6.59825,-7.55566,8.42359,-23.67053,12.82461 ,
    -5.69332,1.55486,-9.56846,4.61164,-11.64687,9.18724 ,
    -2.06687,4.55022,-1.94496,8.4026,0.42423,13.40561 ,
    2.98235,6.29778,6.23373,8.92113,28.50763,23.00108 ,
    12.5589,7.93883,16.29595,11.93459,16.29595,17.42409 ,
    0,3.43503,-4.05703,7.278,-9.33947,8.84672 ,
    -13.00564,3.86226,-46.09416,5.53144,-55.00864,2.77496 ,
    -4.92249,-1.5221,-13.95928,-6.94734,-26.74207,-16.05461 ,
    -4.36648,-3.11096,-10.19541,-6.79465,-12.95319,-8.18599 ,
    -3.25152,-1.64044,-7.09042,-4.69573,-10.92055,-8.69139 ,
    -5.60461,-5.84681,-6.0957,-6.16144,-9.61043,-6.15701 ,
    -5.08794,0.007,-8.87906,1.17141,-19.58212,6.01753 ,
    -8.07912,3.65805,-10.17798,4.24958,-17.32774,4.88357 ,
    -8.504,0.75407,-10.96752,1.53438,-11.81479,3.74231 ,
    -0.70551,1.83855,1.45068,6.64129,5.22734,11.64345 ,
    7.1791,9.50864,7.60704,12.6851,2.39618,17.78606 ,
    -5.78968,5.66756,-10.02555,7.06471,-22.29064,7.3523 ,
    -5.7806,0.13555,-16.15109,-0.0822,-23.04553,-0.48387 ,
};

double rabbit_ear[] = {
    281.34936, 9.9115226 ,
    -4.37954,0.8776704,-7.7704,3.0423104,-9.57289,6.3329604 ,
    -1.27064,2.31968,-1.42002,6.190449,-1.42002,36.85522 ,
    0,29.85571,0.18507,34.93239,1.4396,39.46512 ,
    3.02194,10.918467,11.46338,24.804467,27.90421,45.900927 ,
    0.37945,0.4869,0.68772,0.91516,1.03645,1.37594 ,
    8.21476,9.10984,12.65385,33.64366,19.14976,31.95949 ,
    3.0208,-0.78319,-1.472,-22.40469,3.34001,-45.32983 ,
    8.2838,-39.465267,10.10993,-91.423657,-41.87712,-116.5598274 ,
};

double rabbit_nose[] = {
    484.2325, 240.68676 ,
    -2.65397,-0.0182,-5.9043,0.79663,-7.32032,2.30273 ,
    -0.81477,0.86661,3.72732,7.75042,6.59375,8.76954 ,
    0.85421,8.28397,-2.44757,16.96052,-6.45507,20.62695 ,
    4.02077,-3.67857,8.60362,-12.47163,7.87304,-20.78906 ,
    1.51417,-1.30142,3.62719,-7.39412,3.27735,-9.28907 ,
    -0.201,-1.08865,-1.90456,-1.60692,-3.96875,-1.62109 ,
};

double rabbit_eye[] = {
    418.24099, 211.18811 ,
    -8.82857,2.25022,-21.82038,12.05667,-28.63647,-10.65097 ,
    13.84924,-13.06973,25.45245,-4.20425,28.63647,10.65097 ,
};

double rabbit_iris[] = {
    402.84023, 194.18711 ,
    -2.40077,-0.0262,-4.99231,0.6687,-7.7138,2.20021 ,
    -2.08676,2.22111,-3.23345,5.06567,-3.23886,8.11327 ,
    0.004,0.81302,0.0739,1.71043,0.24212,2.50588 ,
    5.47317,10.77379,13.22376,8.70074,20.08267,6.22196 ,
    2.43754,-2.2168,3.71387,-5.36053,3.67246,-8.6409 ,
    -0.002,-0.15406,-0.008,-0.30806,-0.0163,-0.46191 ,
    -2.85646,-5.958,-7.42801,-9.87729,-13.02827,-9.93851 ,
};

void draw_curve(cairo_t *ctx, double *c, int len) {
    cairo_move_to(ctx, c[0], c[1]);
    int i = 2;
    while (i < len) {
        cairo_rel_curve_to(ctx, c[i], c[i+1], c[i+2], c[i+3], c[i+4], c[i+5]);
        i += 6;
    }
    cairo_close_path(ctx);
}

void draw_rabbit(cairo_t *ctx, double size) {
    cairo_save(ctx);
    cairo_scale(ctx, size/520, size/520);
    
    
    // body
    draw_curve(ctx, rabbit_body, sizeof(rabbit_body)/sizeof(double));
    cairo_set_source_rgb(ctx, 1, 1, 1);
    cairo_fill(ctx);

    // ear
    draw_curve(ctx, rabbit_ear, sizeof(rabbit_ear)/sizeof(double));
    cairo_pattern_t *p = cairo_pattern_create_linear(0, 50, 0, 180);
    cairo_pattern_add_color_stop_rgb(p, 0, 0.97, 0.80, 0.77);
    cairo_pattern_add_color_stop_rgb(p, 1, 1, 1, 1);
    cairo_set_source(ctx, p);
    cairo_fill(ctx);
    cairo_pattern_destroy(p);

    // nose
    draw_curve(ctx, rabbit_nose, sizeof(rabbit_nose)/sizeof(double));
    cairo_set_source_rgb(ctx, 0.83, 0.42, 0.42);
    cairo_fill(ctx);

    // eye
    draw_curve(ctx, rabbit_eye, sizeof(rabbit_eye)/sizeof(double));
    cairo_set_source_rgb(ctx, 0.83, 0.42, 0.42);
    cairo_fill(ctx);

    // iris
    draw_curve(ctx, rabbit_iris, sizeof(rabbit_iris)/sizeof(double));
    p = cairo_pattern_create_radial(402, 212, 0, 402, 212, 20);
    cairo_pattern_add_color_stop_rgb(p, 0, 0.45, 0.12, 0.12);
    cairo_pattern_add_color_stop_rgb(p, 1, 0.1, 0, 0);
    cairo_set_source(ctx, p);
    cairo_fill(ctx);
    cairo_pattern_destroy(p);

    // pupil
    cairo_arc(ctx, 403.87778, 204.58762, 5.6360383, 0, 2*M_PI);
    cairo_set_source_rgb(ctx, 0, 0, 0);
    cairo_fill(ctx);

    // eye light shade
    cairo_arc(ctx, 406.86868, 193.56003, 14.73912, 0, 2*M_PI);
    p = cairo_pattern_create_linear(0, 180, 0, 207.4);
    cairo_pattern_add_color_stop_rgba(p, 0, 1, 1, 1, 1);
    cairo_pattern_add_color_stop_rgba(p, 1, 1, 1, 1, 0);
    cairo_set_source(ctx, p);
    cairo_fill(ctx);
    cairo_pattern_destroy(p);

    // eye glare
    cairo_arc(ctx, 403.12625, 199.06589, 2.5047338, 0, 2*M_PI);
    cairo_set_source_rgb(ctx, 1, 1, 1);
    cairo_fill(ctx);


    cairo_restore(ctx);
}